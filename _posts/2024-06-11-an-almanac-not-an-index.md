---
title: An Almanac, Not An Index
subtitle: Pattern-matching for weather prediction
author: Jeremy
tags: [essay, progress, worldline]
permalink: /an-almanac-not-an-index
date: 2024-06-11
excerpt_separator: <!--more-->
---

In 1921, [Lewis Fry Richardson](https://en.wikipedia.org/wiki/Lewis_Fry_Richardson) wasn’t satisfied with the current state of weather forecasting. His criticism of the paradigm was fundamental: it relied on pattern-matching instead of modeling the physics of the atmosphere. In the preface of his book _[Weather Prediction By Numerical Process](https://archive.org/details/weatherpredictio00richrich/weatherpredictio00richrich/page/n9/mode/2up?ref=ol))_, which would go on to revolutionize how meteorologists forecast the weather, he described the dominant approach:

> The process of forecasting, which has been carried on in London for many years, may be typified by one of its latest developments, namely Col. E. Gold’s _Index of Weather Maps_. It would be difficult to imagine anything more immediately practical. The observing stations telegraph the elements of present weather. At the head office these particulars are set in their places upon a large-scale map. The index then enables the forecaster to find a number of previous maps which resemble the present one. The forecast is based on the supposition that what the atmosphere did then, it will do again now. There is no troublesome calculation, with its possibilities of theoretical or arithmetical error. The past history of the atmosphere is used, so to speak, as a full-scale working model of its present self.

Richardson, as well as meteorologists [Cleveland Abbe](https://en.wikipedia.org/wiki/Cleveland_Abbe) and [Vilhelm Bjerknes](https://en.wikipedia.org/wiki/Vilhelm_Bjerknes), wanted to infuse the discipline of meteorology with a more scientific approach. Indeed, Abbe [wrote in 1901](https://journals.ametsoc.org/view/journals/mwre/29/12/1520-0493_1901_29_551c_tpbolw_2_0_co_2.xml) that the predictions, “merely represent the direct teachings of experience; they are generalizations based upon observations but into which physical theories have as yet entered in only a superficial manner if at all.”<!--more-->

I was unable to find the _Index of Weather Maps_ (if anyone has a digital copy, please get in touch!), but it seems as though Richardson was referring to [Ernest Gold](https://en.wikipedia.org/wiki/Ernest_Gold_(meteorologist))’s _Aids to Forecasting_ (1920). The book is so old that I do not have a copy of it either, but a [review in Science](https://www.science.org/doi/10.1126/science.52.1337.155.b) notes that Gold surveyed the Met Office’s [Daily Weather Report](https://library.metoffice.gov.uk/Portal/Default/en-GB/recordview/index/626306) for fourteen years of its reports and categorized the weather into similar “indices”. A forecaster could then check the index to find a match for current weather and follow how the weather unfolded in those past examples. The weather prediction would be the closest match to present conditions. However, as the _Science_ reviewer noted, “The weakness of any such classification is, of course, the assumption that like surface isobaric conformations are always followed by similar weather conditions.”

To give you a sense of what these weather reports looked like, below are a few pages for the January 1, [1910](https://digital.nmla.metoffice.gov.uk/IO_c22fc700-f55c-425d-b855-c0646cd419b5/) entry. It’s essentially a logbook, where the writer collates all the incoming information from the weather stations, fills out the blank maps to show readings for the wind, pressure (barometer), and temperature, and includes particular notes for the day.

{% include image.html url="/images/almanac/weather-chart.png" description="A spread from the Met Office’s Daily Weather Report for January 1, 1910. The layout of the pages is the same for each day, and simply the notes and annotations change. Shown here is one day of many included in the scan." source="https://digital.nmla.metoffice.gov.uk/IO_c22fc700-f55c-425d-b855-c0646cd419b5/" alttext="" %}

Richardson wasn't satisfied with searching through an index though. He admired a different publication: _[The Nautical Almanac](https://en.wikipedia.org/wiki/The_Nautical_Almanac)_ (a log of predictions for star positions to help with sea navigation, as well as official dates for holidays). He wrote, “that marvel of accurate forecasting, is not based on the principle that astronomical history repeats itself in the aggregate.” If you take a look at [this copy](https://babel.hathitrust.org/cgi/pt?id=mdp.39015068169930&seq=1), you will quickly encounter formulas and mathematical expressions. This is in contrast to the weather reports, which were just measurements. While Richardson valued data (this is how he made his predictions, after all), he thought simply comparing to old data was bound to be a dead end. Instead, he wanted to model the weather as a physics problem. And he did, resulting in [a framework that helps us forecast the weather](https://chartingprogress.substack.com/p/weather-forecasting) much more accurately into the future than we once did.

---

What’s striking to me about Richardson's criticism is that it boiled down to this: Pattern matching with data isn’t enough for useful prediction. And while that may seem reasonable, haven’t we just seen a remarkable reversal of that idea in the form of machine learning? [Large language models](https://en.wikipedia.org/wiki/Large_language_model) in particular are becoming more and more capable of accomplishing tasks. Can we use machine learning for weather prediction?

There are three reasons to be hopeful about machine learning techniques in weather prediction. First, meteorological stations have rich data sets stretching back decades ([and some for over a century](https://celebrating200years.noaa.gov/foundations/weather_obs/welcome.html)). This means extensive training data for models[^1]. In fact, the [European Centre for Medium-Range Weather Forecasts](https://www.ecmwf.int/en/about) (ECMWF) [reports](https://www.ecmwf.int/en/elibrary/81155-ecmwf-scalability-programme-progress-and-plans) that their forecasts take up terabytes of data, and will significantly increase over time (see Figure 11 of the report)[^2]. Second, there’s always a ground truth for weather forecasts. Assuming the observational instruments are working correctly, we can rapidly see if a prediction was right or wrong. This helps when evaluating the performance of a model. Third, running a traditional weather prediction model is expensive. That’s because you must simulate the physics of the atmosphere, which has feedback loops at multiple scales and requires solving many interdependent equations. The exact energy, time, and cost footprints depend on the model, hardware, and kind of simulation (near-term weather versus climate predictions), but climate scientist [Tapio Schneider](https://climate-dynamics.org/tapio-schneider/) said in [a recent article](https://www.nature.com/articles/d41586-024-00780-8) that a climate simulation can consume up to 10 megawatt hours of energy. For context, the article notes that this is about the [average energy consumption of a U.S. household in a year](https://www.eia.gov/energyexplained/use-of-energy/electricity-use-in-homes.php#:~:text=The%20average%20U.S.%20household%20consumes%20about%2010%2C500%20kilowatthours%20(kWh)%20of%20electricity%20per%20year.1). While it’s true that training machine learning models is an upfront cost, there are huge efficiencies in actually outputting a forecast, such as [taking one minute on a single TPU to produce a 10-day forecast versus hours on supercomputers with hundreds of machines](https://www.nature.com/articles/s44287-023-00009-2#:~:text=Despite%20the%20computationally,hundreds%20of%20machines.)[^3].

What caught my attention though was the involvement of the ECMWF in exploring machine learning for their operations. The ECMWF is a research institute but it is also an operational service, providing weather forecasts every day to many countries. It's one thing to have academics interested in using a new type of tool to solve a problem. It's quite another for an organization who has a product to consider incorporating a new tool into their workflow.

In 2021, the ECMWF released a [ten-year roadmap](https://www.ecmwf.int/en/elibrary/81207-machine-learning-ecmwf-roadmap-next-10-years) for how they plan to incorporate machine learning methods into their workflow. They note that, “Machine learning can be used to improve the computational efficiency of weather and climate models, to extract information from data, or to post-process model output, in particular if data-driven machine learning methods can be combined with conventional tools.” Though we have faster computers than ever before, conventional weather models always require more compute, because we want higher resolution, longer forecasts, and more simulations for predictions. Any gain in compute efficiency will translate into increasing these variables.

Many of [their efforts and those in the past](https://www.ecmwf.int/en/about/media-centre/science-blog/2023/rise-machine-learning-weather-forecasting) have occurred in only the past few years, which means there is still a ton to do in this space. The ECMWF’s [own initial perspective](https://www.ecmwf.int/en/about/media-centre/science-blog/2023/rise-machine-learning-weather-forecasting#:~:text=The%20preliminary%20conclusion%20was%20that%20this%20was%20an%20interesting%20research%20problem%20to%20explore%2C%20but%20the%20likelihood%20of%20it%20becoming%20operational%20was%20low%2C%20so%20it%20was%20not%20a%20wise%20investment%20of%20ECMWF%20resources.%C2%A0) was that machine learning was an interesting avenue to explore, but “the likelihood of it becoming operational was low, so it was not a wise investment of ECMWF resources.” And yet, [they realized](https://www.ecmwf.int/en/about/media-centre/science-blog/2023/rise-machine-learning-weather-forecasting#:~:text=The%20situation%20changed%20rapidly%2C%20between%20February%202022%20and%20April%202023.%C2%A0) that the situation changed in 2022 and 2023, when companies such as [NVIDIA](https://docs.nvidia.com/deeplearning/modulus/modulus-v2209/user_guide/neural_operators/fourcastnet.html), [Huawei](https://arxiv.org/abs/2211.02556), and [DeepMind](https://deepmind.google/discover/blog/graphcast-ai-model-for-faster-and-more-accurate-global-weather-forecasting/) released machine learning models that [rivaled traditional methods](https://www.ecmwf.int/en/about/media-centre/science-blog/2023/rise-machine-learning-weather-forecasting#:~:text=First%2C%20the%20headline,public%20papers).). These results had enough of an impact on ECMWF that they are now investigating how to incorporate machine learning into their workflow.

They also note that there are many challenges in using machine learning tools for weather forecasting. These include the requirement for custom machine learning solutions for the weather, refactoring code to take advantage of the machine learning libraries in Python or Julia (many conventional weather forecasting code is in Fortran), and barriers in communication between Earth scientists and machine learning researchers. The ECMWF's plans to address these challenges over the course of their roadmap.

---

The future of operational weather forecasting probably won’t be just machine learning or just physics-based simulation, but a hybrid of the two. Hopefully, the ECMWF and other organizations can figure out how to augment and complement their workflows such that machine learning becomes an asset, not just a curiosity. I’m excited by the potential reduction in compute time using machine learning, which would allow meteorologists to combine a greater number of simulations to make an ensemble prediction.

Going back to Abbe, Bjerknes, and Richardson, it appears that enough data really can lead to good predictions. What we’ve seen in the past few years with machine learning is that scale matters. To echo what [Philip Anderson](https://en.wikipedia.org/wiki/Philip_W._Anderson) once said within the context of condensed matter physics, “[More is different](https://www.science.org/doi/10.1126/science.177.4047.393).”


## Endnotes

[^1]:
     Note that older data may not be as useful, since it wasn’t as comprehensive as our data collection system today.

[^2]:
     They also say that this volume of data is becoming more and more difficult to handle, which poses a problem as they aim to increase the resolution of their forecasts (requiring more data).

[^3]:
     A [tensor processing unit](https://en.wikipedia.org/wiki/Tensor_Processing_Unit) is a device that Google built specifically for machine learning applications.
